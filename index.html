<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vinted Feed Demo Minimaliste</title>
<style>
:root{
  --bg:#f0f2f5; --card:#ffffff; --text:#0f1720; --muted:#6b7280;
}
body.dark{ --bg:#0b1020; --card:#0f1720; --text:#e6eef8; --muted:#9aa6bf; }
body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text);}
#app{display:flex;min-height:100vh;}
#settings{width:260px;padding:12px;background:var(--card);box-shadow:2px 0 12px rgba(0,0,0,0.08);}
#cardArea{flex:1;display:flex;justify-content:center;align-items:center;position:relative;overflow:hidden;}
.card{position:absolute;width:320px;background:var(--card);border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.12);display:flex;flex-direction:column;align-items:center;padding:12px;transition:transform .35s ease,opacity .3s;}
.card img{width:100%;height:200px;object-fit:cover;border-radius:8px;}
.card h3{margin:8px 0 4px;font-size:18px;text-align:center;}
.card .meta{font-size:14px;color:var(--muted);text-align:center;}
.cardBtns{display:flex;justify-content:space-between;width:100%;margin-top:10px;}
.action{width:48%;padding:8px;border-radius:10px;font-weight:700;cursor:pointer;border:none;}
.skip{background:#ffecec;color:#b02a2a;}
.like{background:#e6ffef;color:#047857;}
#toggleTheme{margin-bottom:12px;padding:6px 10px;border-radius:8px;border:none;cursor:pointer;}
.brand-btn{display:block;margin-bottom:6px;padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.06);cursor:pointer;background:transparent;}
.brand-btn.active{background:#2227ff10;border-color:#2227ff50;}
input[type="number"]{width:100%;padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.08);margin-bottom:12px;}
#overlay{position:fixed;inset:0;background:rgba(2,6,23,0.55);display:flex;align-items:center;justify-content:center;z-index:999;}
.loginCard{background:var(--card);padding:20px;border-radius:12px;width:360px;box-shadow:0 12px 40px rgba(0,0,0,0.4);text-align:center;}
.loginCard button{margin-top:12px;padding:8px 12px;border-radius:8px;border:none;background:#5865f2;color:white;cursor:pointer;}
</style>
</head>
<body>
<div id="overlay">
  <div class="loginCard">
    <h3>Connexion via le bot</h3>
    <p>Simulation de connexion Discord pour la démo</p>
    <button id="loginBtn">Se connecter</button>
  </div>
</div>

<div id="app">
  <div id="settings">
    <button id="toggleTheme">Mode Sombre</button>
    <h4>Marques préférées</h4>
    <div id="brandsList"></div>
    <h4>Seuil gain (€)</h4>
    <input type="number" id="minGain" value="20" min="0">
    <div class="cardBtns">
      <button id="btnSkip" class="skip">Passer</button>
      <button id="btnLike" class="like">Garder</button>
    </div>
  </div>
  <div id="cardArea">
    <div style="color:var(--muted);text-align:center;">Veuillez vous connecter via le bot pour voir les articles.</div>
  </div>
</div>

<script>
// ===== Variables =====
const brands=["Nike","Adidas","Ralph Lauren","CP Company","Puma","Reebok","Under Armour","New Balance","Converse","Vans","The North Face","Columbia","Patagonia","Fila","Champion","Tommy Hilfiger","Lacoste","Jordan","Asics","Carhartt"];
const brandsListEl=document.getElementById('brandsList');
const selectedBrands=new Set(brands);
let cardStack=[],currentUser=null;
const MAX_CARDS=30;
const cardArea=document.getElementById('cardArea');
const minGainInput=document.getElementById('minGain');
const overlay=document.getElementById('overlay');

// ===== Création des boutons marques =====
brands.forEach(b=>{
  const btn=document.createElement('button');
  btn.textContent=b; btn.className='brand-btn active';
  btn.onclick=()=>{
    if(btn.classList.contains('active')){btn.classList.remove('active');selectedBrands.delete(b);}
    else{btn.classList.add('active');selectedBrands.add(b);}
    refillCards();
  };
  brandsListEl.appendChild(btn);
});

// ===== Mode sombre =====
document.getElementById('toggleTheme').onclick=()=>{
  document.body.classList.toggle('dark');
  document.getElementById('toggleTheme').textContent=document.body.classList.contains('dark')?'Mode Clair':'Mode Sombre';
};

// ===== Login simulé =====
document.getElementById('loginBtn').onclick=()=>{
  currentUser={name:'exemple#1234'};
  overlay.style.display='none';
  refillCards();
};

// ===== Génération article aléatoire =====
function generateArticle(i){
  const brand=brands[Math.floor(Math.random()*brands.length)];
  const price_vinted=Math.floor(Math.random()*90)+10;
  const price_ebay=price_vinted+Math.floor(Math.random()*200)+10;
  const gain=price_ebay-price_vinted;
  return {id:'a-'+Date.now()+'-'+i,name:`${brand} Article ${Math.floor(Math.random()*9999)}`,brand,price_vinted,price_ebay,gain,image:`https://via.placeholder.com/320x200?text=${encodeURIComponent(brand)}`};
}

// ===== Affichage cartes =====
function refillCards(){
  if(!currentUser) return;
  cardStack=[];
  const mg=parseInt(minGainInput.value)||20;
  let tries=0;
  while(cardStack.length<MAX_CARDS && tries<MAX_CARDS*6){
    const a=generateArticle(tries);
    if(selectedBrands.has(a.brand)&&a.gain>=mg) cardStack.push(a);
    tries++;
  }
  renderStack();
}
function renderStack(){
  cardArea.innerHTML='';
  if(cardStack.length===0){cardArea.innerHTML='<div style="color:var(--muted);text-align:center;">Aucun article trouvé</div>'; return;}
  for(let i=cardStack.length-1;i>=0;i--){
    const art=cardStack[i];
    const el=document.createElement('div');
    el.className='card'; el.dataset.id=art.id;
    el.style.zIndex=100+i; el.style.transform=`scale(${1-(cardStack.length-1-i)*0.02}) translateY(${(cardStack.length-1-i)*6}px)`;
    el.innerHTML=`<img src="${art.image}" alt="${art.name}"><h3>${art.name}</h3><div class="meta">${art.brand}</div><div class="meta">Prix: €${art.price_vinted} · Gain: €${art.gain}</div><div class="cardBtns"><button class="action skip">Passer</button><button class="action like">Garder</button></div>`;
    el.querySelector('.skip').onclick=()=> swipeLeft(art.id);
    el.querySelector('.like').onclick=()=> swipeRight(art.id);
    cardArea.appendChild(el);
  }
}

// ===== Swipe =====
function swipeLeft(id){animateSwipe(id,-1);}
function swipeRight(id){animateSwipe(id,1);}
function animateSwipe(id,dir){
  const el=cardArea.querySelector(`.card[data-id="${id}"]`); if(!el) return;
  el.style.transition='transform .45s ease, opacity .3s';
  el.style.transform=`translateX(${dir*800}px) rotate(${dir*10}deg)`;
  el.style.opacity='0';
  setTimeout(()=>{
    cardStack=cardStack.filter(c=>c.id!==id);
    addNewArticles(1);
    renderStack();
  },450);
}
function addNewArticles(n){
  const mg=parseInt(minGainInput.value)||20; let tries=0;
  while(n>0&&tries<200){
    const a=generateArticle(tries);
    if(selectedBrands.has(a.brand)&&a.gain>=mg){cardStack.unshift(a); n--;}
    tries++;
  }
  if(cardStack.length>MAX_CARDS) cardStack=cardStack.slice(0,MAX_CARDS);
}

// ===== Boutons passer/garder =====
document.getElementById('btnSkip').onclick=()=>{if(cardStack.length) swipeLeft(cardStack[0].id);};
document.getElementById('btnLike').onclick=()=>{if(cardStack.length) swipeRight(cardStack[0].id);};

// ===== Clavier =====
document.addEventListener('keydown',e=>{if(e.key==='ArrowLeft'&&cardStack.length) swipeLeft(cardStack[0].id); else if(e.key==='ArrowRight'&&cardStack.length) swipeRight(cardStack[0].id);});

// ===== Update périodique =====
setInterval(()=>{if(!currentUser) return; addNewArticles(2); renderStack();},30000);
</script>
</body>
</html>
